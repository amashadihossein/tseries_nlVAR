<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="Afshin Mashadi-Hossein">
  <title>Time-series Inference Using a Non-linear Vector Autoregressive Model</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="site_libs/quarto-diagram/mermaid.min.js"></script>
  <script src="site_libs/quarto-diagram/mermaid-init.js"></script>
  <link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#212121" class="quarto-title-block center">
  <h1 class="title">Time-series Inference Using a Non-linear Vector Autoregressive Model</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Afshin Mashadi-Hossein 
</div>
</div>
</div>

  <p class="date">3/7/23</p>
</section>
<section id="overview" class="slide level2">
<h2>Overview</h2>
<div style="font-size:24px">
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="motivation">1- Motivation</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/2">Typical problem</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/3">Data generation as DAG</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/5">Simulating the DAG</a></p>
<h3 id="background-and-notation">2- Background and Notation</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/9">DAGs and matrix representation</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/10">Conditional Independence</a></p>
<h3 id="vector-autoregressive-var-models">3- Vector Autoregressive (VAR) Models</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/11">A Toy example</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/8">Est VAR in high dimensional setting</a></p>
</div><div class="column" style="width:50%;">
<h3 id="network-inference">4- Network Inference</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/13">Thresholded LASSO</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/15">Generalizing to higher order</a></p>
<h3 id="solution-refinements">5- Solution refinements</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/15">Model Tuning</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/16">Extended BIC</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/17">Dealing with uncertainty in obs window</a></p>
</div>
</div>
</div>
</section>
<section id="motivation-1" class="slide level2">
<h2>Motivation</h2>
<p>Given the case of an allergic reaction that is mediated through a measurable biomarker, consider the question re efficacy of treatment.</p>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell" data-reveal="true">
<div class="cell-output-display">
<div>
<p>
</p><pre class="mermaid mermaid-js" data-tooltip-selector="#mermaid-tooltip-1">flowchart TD
  A((exposure)) --&gt; B((biomarker))
  C((treatment)) --&gt; B
  B --&gt; D((reaction))
</pre>
<div id="mermaid-tooltip-1" class="mermaidTooltip">

</div>
<p></p>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<p><img data-src="images/data_motivation.png"></p>
</div>
</div>
</section>
<section id="motivation-2" class="slide level2">
<h2>Motivation</h2>
<p>A slightly more realistic view of the data generation mechanism accounts (at least) for the first order temporal <em>flow</em> of the signal</p>

<img data-src="images/dag_motivation.png" class="r-stretch quarto-figure-center"><p class="caption">Data Generation Viewed as DAG</p></section>
<section id="motivation-3" class="slide level2">
<h2>Motivation</h2>
<p>In this context, of primary interests are the effect of treatment <span class="math inline">\(A_{trt}(t)\)</span> on the mediating biomarker <span class="math inline">\(X_1(t)\)</span> and more importantly, the effect of <span class="math inline">\(X_1(t)\)</span> on the outcome <span class="math inline">\(Y_1(t)\)</span> (e.g.&nbsp;allergic reaction). Addressing the questions, could be viewed as a <strong>Network Inference</strong> problem.</p>

<img data-src="images/dag_motivation_highlighted.png" class="r-stretch quarto-figure-center"><p class="caption">Data Generation Viewed as DAG</p></section>
<section id="simulation" class="slide level2">
<h2>Simulation</h2>
<div style="font-size:24px">
<p>To make our mental model of the process even more explicitly defined, let’s consider the following DAG</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/sim_dag.png"></p>
<p></p><figcaption>Simulation Dag t: baseline through 3</figcaption><p></p>
</figure>
</div>
</div>
</section>
<section id="simulation-1" class="slide level2">
<h2>Simulation</h2>
<p>The DAG can be implemented in <code>simcausal</code> as follows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>t_obs <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>t.end <span class="ot">&lt;-</span> <span class="fu">length</span>(t_obs)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>D <span class="ot">&lt;-</span> <span class="fu">DAG.empty</span>() <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="fu">node</span>(<span class="at">name =</span> <span class="st">"allergic"</span>, <span class="at">distr =</span> <span class="st">"rbern"</span>, <span class="at">prob =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="fu">node</span>(<span class="at">name =</span> <span class="st">"responder"</span>, <span class="at">distr =</span> <span class="st">"rbern"</span>, <span class="at">prob =</span> .<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="fu">node</span>(<span class="at">name =</span> <span class="st">"unitnoise"</span>, <span class="at">distr=</span><span class="st">"rnorm"</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>.<span class="dv">05</span>) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="fu">node</span>(<span class="at">name =</span> <span class="st">"trt"</span>, <span class="at">t =</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>t.end,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>)), <span class="at">distr =</span> <span class="st">"rbern"</span>, <span class="at">prob =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>  <span class="fu">node</span>(<span class="at">name =</span> <span class="st">"trt"</span>, <span class="at">t =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">distr =</span> <span class="st">"rbern"</span>, </span>
<span id="cb1-10"><a href="#cb1-10"></a>       <span class="at">prob =</span> <span class="fu">plogis</span>( (x1bar[t<span class="dv">-1</span>] <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">*</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="fu">node</span>(<span class="at">name =</span> <span class="st">"pk"</span>, <span class="at">t =</span> <span class="dv">1</span>, <span class="at">distr =</span> <span class="st">"rbern"</span>, <span class="at">prob =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="fu">node</span>(<span class="at">name =</span> <span class="st">"pk"</span>, <span class="at">t =</span> <span class="dv">2</span><span class="sc">:</span>t.end, <span class="at">distr =</span> <span class="st">"getPk"</span>, <span class="at">pkm1 =</span> pk[t<span class="dv">-1</span>], <span class="at">rx =</span> trt[t])<span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="fu">node</span>(<span class="at">name =</span> <span class="st">"x1bar"</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>t.end, <span class="at">distr =</span> <span class="st">"aveProfile"</span>, <span class="at">time=</span>t, <span class="at">pk =</span> pk[t],</span>
<span id="cb1-14"><a href="#cb1-14"></a>       <span class="at">allergic=</span>allergic, <span class="at">unitnoise =</span> unitnoise) <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>  <span class="fu">node</span>(<span class="at">name =</span> <span class="st">"x2bar"</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>t.end, <span class="at">distr =</span> <span class="st">"aveProfile2"</span>, <span class="at">time=</span>t,</span>
<span id="cb1-16"><a href="#cb1-16"></a>       <span class="at">allergic=</span>allergic, <span class="at">unitnoise =</span> unitnoise, <span class="at">x1bar =</span> x1bar[t], </span>
<span id="cb1-17"><a href="#cb1-17"></a>       <span class="at">responder =</span> responder) <span class="sc">+</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>  </span>
<span id="cb1-19"><a href="#cb1-19"></a>  <span class="fu">node</span>(<span class="at">name =</span> <span class="st">"rxn"</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>t.end, <span class="at">distr =</span> <span class="st">"rbern"</span>,</span>
<span id="cb1-20"><a href="#cb1-20"></a>       <span class="at">prob =</span> <span class="fu">plogis</span>( (x2bar[t] <span class="sc">-</span> <span class="fl">0.65</span>) <span class="sc">*</span> <span class="dv">30</span>))</span>
<span id="cb1-21"><a href="#cb1-21"></a>  </span>
<span id="cb1-22"><a href="#cb1-22"></a>  obj_D <span class="ot">&lt;-</span> <span class="fu">set.DAG</span>(D)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="motivation-simulation" class="slide level2">
<h2>Motivation: Simulation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>sim_xbar <span class="ot">&lt;-</span> simcausal<span class="sc">::</span><span class="fu">sim</span>(<span class="at">DAG =</span> obj_D,<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>sim_xbar_long <span class="ot">&lt;-</span> <span class="fu">format_long</span>(sim_xbar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="tseries_nlVAR_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="motivation-simulation-1" class="slide level2">
<h2>Motivation: Simulation</h2>

<img data-src="tseries_nlVAR_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="background-and-notation-1" class="slide level2">
<h2>Background and Notation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Network: Nodes + Edges</p>
<p><img data-src="images/net_bg_notation.png"></p>
</div><div class="column" style="width:50%;">
<p>Adjacency matrix: not-directed</p>
<p><span class="math display">\[A_{0/1} = \begin{bmatrix}
0 &amp; 1 &amp; 1 &amp; 0  \\
1 &amp; 0 &amp; 1 &amp; 0  \\
1 &amp; 1 &amp; 0 &amp; 1  \\
0 &amp; 0 &amp; 1 &amp; 0  \\
\end{bmatrix}\]</span></p>
<p>Adjacency matrix: directed <span class="math display">\[A = \begin{bmatrix}
0.0 &amp; 0.5 &amp; 2.0 &amp; 0.0  \\
0.0 &amp; 0.0 &amp; 1.0 &amp; 0.0  \\
0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0  \\
0.0 &amp; 0.0 &amp; -1.0 &amp; 0.0  \\
\end{bmatrix}\]</span></p>
</div>
</div>
</section>
<section id="background-and-notation-2" class="slide level2">
<h2>Background and Notation</h2>
<div style="font-size:24px">
<p><strong>Data representation:</strong></p>
<ul>
<li><span class="math inline">\(X^t\)</span>: Observations (data) at time <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(X^t \in R^{nxp}\)</span>: <span class="math inline">\(X\)</span> contains <span class="math inline">\(n\)</span> observations on <span class="math inline">\(p\)</span> nodes at time <span class="math inline">\(t\)</span></li>
</ul>
<h3 id="note-on-conditional-independence">Note on conditional independence</h3>
<p>Consider</p>
<div class="cell" data-reveal="true">
<div class="cell-output-display">
<div>
<p>
</p><pre class="mermaid mermaid-js" data-tooltip-selector="#mermaid-tooltip-2">flowchart LR
  x1((A)) --&gt; x2((B))
  x2 --&gt; x3((C))
</pre>
<div id="mermaid-tooltip-2" class="mermaidTooltip">

</div>
<p></p>
</div>
</div>
</div>
<p>For this simple graph, conditional independence can be stated as</p>
<p><span class="math display">\[C \not\!\perp\!\!\!\perp A | B\]</span> As the number of nodes, <span class="math inline">\(p\)</span>, grows, establishing conditional independence globally becomes challenging and many network inference algorithms rely on some variation of pairwise scoring between nodes, which is much more tractable. However, those algorithms are more prone to false edge discovery.</p>
</div>
</section>
<section id="establishing-conditional-independence-through-regression" class="slide level2">
<h2>Establishing Conditional Independence Through Regression</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>xx <span class="ot">&lt;-</span> sim_xbar_long <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, t, x1) <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> t,<span class="at">values_from =</span> x1, <span class="at">names_prefix =</span> <span class="st">"t_"</span>) </span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>xx <span class="sc">%&gt;%</span> <span class="fu">select</span>(t_1, t_2, t_3) <span class="sc">%&gt;%</span> plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="tseries_nlVAR_files/figure-revealjs/unnamed-chunk-12-1.png" width="576"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(t_3 <span class="sc">~</span> t_2, <span class="at">data =</span> xx)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">plot</span>(mod<span class="sc">$</span>residuals, xx<span class="sc">$</span>t_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="tseries_nlVAR_files/figure-revealjs/unnamed-chunk-14-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="vector-autoregressive-var-models-1" class="slide level2">
<h2>Vector Autoregressive (VAR) Models</h2>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Network VAR Model: General Idea</strong></p>
</div>
<div class="callout-content">
<p>States observed over the past <span class="math inline">\(d\)</span> time points are predictive of the current observed state, <span class="math inline">\(X^T\)</span></p>
</div>
</div>
</div>
<div style="font-size:24px">
<ul>
<li><p>Example: a network with <span class="math inline">\(p=5\)</span> and <span class="math inline">\(d = 2\)</span> <img data-src="images/var_toy.png" alt="VAR Example"></p></li>
<li><p>Task: estimate <span class="math inline">\(d\)</span> and <span class="math inline">\(A^t\)</span> given <span class="math inline">\(X^t\)</span>, <span class="math inline">\(t \in \{1, ..., T\}\)</span></p></li>
</ul>
<p><span class="math display">\[X^T = X^{T-1}A^1 + ... + X^{T-d}A^d + \epsilon^T, ~ \epsilon^T \sim
\mathcal{MN}(0_{nxp},\sigma^2 I_n, \sigma^2 I_p) ~~ (1)\]</span></p>
</div>
</section>
<section id="estimating-ats-and-d" class="slide level2">
<h2>Estimating <span class="math inline">\(A^t\)</span>s and <span class="math inline">\(d\)</span></h2>
<ul>
<li>Combining <span class="math inline">\(X^T \rightarrow \mathcal{X}\)</span> and stacking <span class="math inline">\(A^t \rightarrow \mathcal{A}\)</span>:</li>
</ul>
<p><span class="math display">\[X^T = \mathcal{X} \mathcal{A} + \epsilon^T, ~\epsilon^T \sim
\mathcal{MN}(0_{nxp},\sigma^2 I_n, \sigma^2 I_p) ~~ (2)\]</span></p>
<ul>
<li><p>Estimating <span class="math inline">\(A^t\)</span>s amounts to regressing columns of <span class="math inline">\(X^T\)</span> on one at a time</p></li>
<li><p>Observing that</p></li>
</ul>
<p>&nbsp; 1. <span class="math inline">\(\mathcal{X}\)</span> is high dimensional (<span class="math inline">\(n \ll p\)</span>) and that</p>
<p>&nbsp; 2. <span class="math inline">\(A^t\)</span> are expected to be sparse</p>
<p>&nbsp; regression involves both variable <strong>selection</strong> (which nodes are connected) and <strong>estimation</strong> (quantification of connection strength). To this end, we can impose a <span class="math inline">\(\ell_1\)</span> type penalty to the regression. To estimate <span class="math inline">\(d\)</span> we could then use thresholded LASSO (Shojaie <em>et al</em>).</p>
</section>
<section id="estimating-ats-and-d-using-thresholded-lasso" class="slide level2">
<h2>Estimating <span class="math inline">\(A^t\)</span>s and <span class="math inline">\(d\)</span> Using Thresholded LASSO</h2>
<div style="font-size:24px">
<p>A 3-Step process for estimating <span class="math inline">\(A^t\)</span>s and d by</p>
<ol type="1">
<li>Estimate <span class="math inline">\(\bar{A^t}\)</span> by fit eq. 2 for each column <span class="math inline">\(j\)</span> of <span class="math inline">\(X^T\)</span></li>
</ol>
<p><span class="math display">\[\underset{{\alpha_0 \in \mathbb{R}^{1},\mathcal{A}_{.j} \in \mathbb{R}^{q} }}{\arg\min} n^{-1}
\| X_{.j}^T  - \alpha_0 - \mathcal{X}\mathcal{A}_{.j}  \|_2^2
+ \lambda \|\mathcal{A}_{.j}\|_1~~(3)\]</span></p>
<ol start="2" type="1">
<li>Threshold <span class="math inline">\(\bar{A^t}\)</span> to get the thresholded est. adj matrix, <span class="math inline">\(\hat{A^t}\)</span></li>
</ol>
<p><span class="math display">\[\hat{A_{ij}^t} = \bar{A_{ij}^t} 1_{\{ \|\bar{A}^t\|_0 &lt; \frac{p^2 \beta}{T-1} \text{ and }  |\bar{A_{ij}^t}| &lt; \tau \}}~~(4)\]</span></p>
<ol start="3" type="1">
<li>Estimate the order of the VAR model, <span class="math inline">\(\hat{d}\)</span>, as follows:</li>
</ol>
<p><span class="math display">\[\hat{d} = \max_{t} \{t: \|\hat{A}^{T-t}\|_0 &lt; \frac{p^2 \beta}{T-1} \}~~(5)\]</span> where <span class="math inline">\(\beta\)</span> is the desired rate of type II error for detecting an edge between two nodes. <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\tau\)</span> are tuning parameters with default values suggested by Shojaie et al.</p>
</div>
</section>
<section id="estimating-ats-and-d-a-toy-example" class="slide level2">
<h2>Estimating <span class="math inline">\(A^t\)</span>s and <span class="math inline">\(d\)</span>: A Toy Example</h2>
<div style="font-size:24px">
<p>The 3-steps procedure for a network of size 3 observed over 3 time-points.</p>
<ol type="1">
<li>Get the adj. mat. estimates <span class="math inline">\([\bar{A^1}~ \bar{A^2}~\bar{A^3}]\)</span> via LASSO regression:</li>
</ol>
<p><span class="math display">\[\begin{bmatrix}
0.00 &amp; 0.00 &amp; 1.00 ~~&amp;~~ 1.00 &amp; 0.00 &amp; 1.00 ~~&amp;~~ 0.10 &amp; 2.00 &amp; 0.90\\
0.00 &amp; 0.00 &amp; 0.00 ~~&amp;~~ 0.00 &amp; 5.00 &amp; 0.00 ~~&amp;~~ 0.00 &amp; 0.00 &amp; 0.00\\
0.00 &amp; 0.00 &amp; 0.00 ~~&amp;~~ 0.35 &amp; 0.32 &amp; 0.09 ~~&amp;~~ 5.00 &amp; 0.20 &amp; 0.15\\
\end{bmatrix}\]</span></p>
<ol start="2" type="1">
<li>Threshold using eq. 4 with <span class="math inline">\(\frac{p^2 \beta}{T-1} = 2\)</span> and <span class="math inline">\(\tau = 1\)</span></li>
</ol>
<p><span class="math display">\[\begin{bmatrix}
0 &amp; 0 &amp; 0 ~~&amp;~~ 1 &amp; 0 &amp; 1 ~~&amp;~~ 0 &amp; 2 &amp; 0\\
0 &amp; 0 &amp; 0 ~~&amp;~~ 0 &amp; 5 &amp; 0 ~~&amp;~~ 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 ~~&amp;~~ 0 &amp; 0 &amp; 0 ~~&amp;~~ 5 &amp; 0 &amp; 0\\
\end{bmatrix}\]</span></p>
<ol start="3" type="1">
<li>Estimate the order: <span class="math inline">\(\hat{d} = \max_{t} \{t: \|\hat{A}^t\|_0 &lt; 2 \} = 2\)</span></li>
</ol>
</div>
</section>
<section id="generalizing-the-model-capturing-higher-order-relations" class="slide level2">
<h2>Generalizing the Model: Capturing Higher Order Relations</h2>
<div style="font-size:24px">
<ul>
<li>VAR model of eq. 1 estimates the linear trends in the inter-relations of nodes</li>
<li>To capture higher order relations, we transform observations using a smoother (e.g.&nbsp;B-spline)</li>
</ul>
<p><span class="math display">\[X^T = Y^{T-1}B^1 + \cdots + Y^{T-d}B^d +\epsilon^T, \epsilon^T \sim \mathcal{MN}(\bf{0}_{\textrm{n} \times \textrm{p}},~\sigma^2I_n ,\sigma^2I_p)~~(6) \]</span> Here, <span class="math inline">\(Y^t = [f(X_{.1}^t), \cdots, f(X_{.p}^t)]\in \mathbb{R}^{\textrm{n}\times \textrm{u}}\)</span></p>
<ul>
<li>We penalize the coefficients by groups corresponding to expansion of a single variable using group LASSO</li>
</ul>
<p><span class="math display">\[\underset{\beta_0 \in \mathbb{R},\mathcal{B}_{.j} \in \mathbb{R}^{s} } {\arg\min}  \frac{1}{2n}
\| X_{.j}^T  - \beta_0 - \mathcal{Y} \mathcal{B}_{.j}  \|_2^2
+ \lambda \sum\limits_{i=1}^p \sqrt{k} \|\mathcal{B}_{g_ij}\|_1, ~~ (7)\]</span></p>
<ul>
<li>Thresholding is done analogous to the linear case but using <span class="math inline">\(\ell^2\)</span> norm of est. coefficient groups.</li>
</ul>
</div>
</section>
<section id="model-tuning-regression-penalty-term-lambda" class="slide level2">
<h2>Model Tuning: Regression Penalty Term <span class="math inline">\(\lambda\)</span></h2>
<div style="font-size:24px">
<ul>
<li><p>Network inference: filter out spurious associations, keep true conditional dependencies</p></li>
<li><p>the larger the penalty, <span class="math inline">\(\lambda\)</span>, the more conservative the filter</p></li>
<li><p>To pick the right level of filtering, there are multiple choices including general cross validation as well as likelihood-based scores, such as Schwarz Bayesian Information Criteria (SBIC) score.</p></li>
</ul>
<p><span class="math display">\[\textrm{SBIC} = \: \log \: \mathcal{L}(\theta_{MLE}|x) - \frac{DOF_{MLE}}{2} \: \log \: n ~~ (8)\]</span> &nbsp; where DOF is the degrees of freedom of MLE model: <span class="math inline">\(\lVert\theta_{MLE}\rVert_0\)</span></p>
<ul>
<li>In the context of linear regression model, <span class="math inline">\(lm\)</span>, and assumption of normality, BIC (which is often represented as SBIC scaled by -2) is simplified (up to a constant) as:</li>
</ul>
<p><span class="math display">\[\textrm{BIC} = \: n \: \log \: \frac{RSS}{n} + DOF_{lm} \: \log \: n ~~ (9)\]</span></p>
</div>
</section>
<section id="model-tuning-bics-flat-prior-assumption" class="slide level2">
<h2>Model Tuning: BIC’s flat Prior Assumption</h2>
<div style="font-size:24px">
<ul>
<li><p>In high-dimensional settings, BIC is too liberal in model selection</p></li>
<li><p>Flat Prior Assumption of Schwarz’s BIC: all possible models equally likely given that we have no information on the network</p></li>
<li><p>Consider the case where there are 1000 parameters (edges) that could be included in the model (network).</p>
<ul>
<li>1 param model choices: <span class="math inline">\(\binom{1000}{1} = 1000\)</span></li>
<li>2 param model choices: <span class="math inline">\(\binom{1000}{2} = 1000 * 999/2\)</span></li>
<li><span class="math inline">\(\rightarrow\)</span> two parameter model are 999/2 more likely than single parameter model</li>
</ul></li>
<li><p>Extended BIC, proposed by Chen and Chen, sets the prior to be flat for model groups of same number of parameters.</p></li>
</ul>
</div>
</section>
<section id="model-tuning-extended-bic-with-widehattextrmdof_textrmgrplasso" class="slide level2">
<h2>Model Tuning: Extended BIC with <span class="math inline">\(\widehat{\textrm{DOF}}_{\textrm{grplasso}}\)</span></h2>
<div style="font-size:24px">
<ul>
<li>Extended BIC (EBIC) is given by</li>
</ul>
<p><span class="math display">\[\textrm{EBIC} = \textrm{BIC} + 2~\textrm{DOF}~\gamma~ log~p,~ \text{where}~  0\leq \gamma ~~(10)\]</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOF is the degrees of freedom and <span class="math inline">\(\gamma\)</span> is a tuning parameter that can be increased as p grows larger<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relative to n.&nbsp;At <span class="math inline">\(\gamma = 0\)</span>, EBIC reduces to BIC</p>
<ul>
<li><p>Note: DOF relates to the number of model parameter. However, the true number of parameters (edges) to estimated itself is unknown <span class="math inline">\(\rightarrow\)</span> We need an estimator for DOF.</p></li>
<li><p>For group LASSO, we can use Vaiter et al.&nbsp;est. DOF</p></li>
</ul>
<p><span class="math display">\[\widehat{\textrm{DOF}}_{\textrm{grplasso}} =  \textrm{Trace}[X_a(X_a'X_a +
\lambda \mathscr{N}(\hat{\beta_a})\odot
(I - P_{\hat{\beta_a}}))^{-1}X_a'] ~~(11)\]</span></p>
<ul>
<li>where <span class="math inline">\(\lambda\)</span> is the group LASSO penalty, <span class="math inline">\(X_a\)</span> and <span class="math inline">\(\hat{\beta_a}\)</span> correspond to ‘selected` groups of variables. <span class="math inline">\(P_{\hat{\beta_a}}\)</span> is a block diagonal matrix, each block the projection matrix of one of the ’selected’ variables. <span class="math inline">\(\mathscr{N}(\hat{\beta_a})\)</span> normalizes each block by its <span class="math inline">\(\ell^2\)</span> norm of <span class="math inline">\(\hat{\beta}_{\textrm{group}}\)</span>.</li>
</ul>
</div>
</section>
<section id="catching-the-signal-in-the-time-course" class="slide level2">
<h2>Catching the ‘Signal’ in the Time Course</h2>
<ul>
<li><p>Conditional dependencies (edges) between nodes are learned from observing nonde-node co-variations</p></li>
<li><p>As a signal propagates through network, different sets of nodes exhibit their co-variations maximally at different time windows</p></li>
<li><p>During which time window should these co-variations be estimated?</p></li>
</ul>

<img data-src="images/catching_the_signal.png" class="r-stretch quarto-figure-center"></section>
<section id="bayesian-model-averaging-bma" class="slide level2">
<h2>Bayesian Model Averaging (BMA)</h2>
<div style="font-size:24px">
<ul>
<li><p>For <span class="math inline">\(\forall~\mathcal{X}_t = [X^{1}, ..., X^{t}]\)</span>, where <span class="math inline">\(t \in \{2,~...,~ T\}\)</span> infer network: <span class="math inline">\(M_t\)</span> and the corresponding graph <span class="math inline">\(G_t\)</span></p></li>
<li><p>Score each inferred network, <span class="math inline">\(M_t\)</span>, using BIC <sup>1</sup>,</p></li>
</ul>
<p><span class="math display">\[w_i = \frac{\exp(-\frac{1}{2} \textrm{BIC}_{i})}{\sum\limits_{j=1}^{T-1}  
\exp(-\frac{1}{2} \textrm{BIC}_j) } ~~(12)\]</span></p>
<ul>
<li>Perform a weighted average of the est. graph</li>
</ul>
<p><span class="math display">\[\hat{\mathcal{G}} = \sum\limits_{t=1}^{T-1}w_t{\hat{G}_t} ~~(13)\]</span></p>
<ul>
<li>Select a thresholding <span class="math inline">\(\mathcal{p} \in [0~1]\)</span> and define thresholded BMA graph , <span class="math inline">\(\breve{\mathcal{G}}\)</span> such that: <span class="math inline">\(\breve{\mathcal{G}}_{ij} = \hat{\mathcal{G}_{ij}} 1_{[\hat{\mathcal{G}_{ij}} &gt; \mathcal{p}]}\)</span></li>
</ul>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>BIC is used generically to refer to EBIC or BIC</p></li></ol></aside></section>
<section id="summary-and-future-work" class="slide level2">
<h2>Summary and Future Work</h2>
<div style="font-size:24px">
<p>The framework described has the following favorable properties</p>
<ul>
<li><p>With some mild assumptions, it can infer network topology based on conditional independence</p></li>
<li><p>It is well-suited high-dimensional data, assuming sparsity of network</p></li>
<li><p>It can handle higher order trajectories</p></li>
<li><p>It expand to simultaneously process evolution of multiple biomarkers</p></li>
<li><p>It can handle experimental fixing of nodes</p></li>
<li><p>It relies on well-established and computationally efficient regression machinery</p></li>
</ul>
<h3 id="feature-work">Feature work</h3>
<ul>
<li><p>Showing efficiency using simulated data</p></li>
<li><p>Expansion to censored data</p></li>
<li><p>Computational parallelization</p></li>
<li><p>Total regression (as opposed to least squared)</p></li>
</ul>
</div>

<div class="footer footer-default">

</div>
</section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>